{"version":3,"sources":["../../../../src/components/hud/base-widget.js"],"names":["WrapperComponent","styled","div","props","theme","__reset__","padding","spacingSmall","display","userStyle","BaseWidget","state","streams","_extractStreams","nextProps","streamNames","streamsMetadata","frame","setState","result","key","streamName","data","style","children","wrapper","PureComponent","PropTypes","object","isRequired","func","getLogState","log","getStreamsMetadata","getCurrentFrame","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAoBA;;AACA;;AACA;;AACA;;AAEA;;;;;;;;;;AAEA,IAAMA,gBAAgB,GAAGC,mBAAOC,GAAP,CAAW,UAAAC,KAAK;AAAA,yCACpCA,KAAK,CAACC,KAAN,CAAYC,SADwB;AAEvCC,IAAAA,OAAO,EAAEH,KAAK,CAACC,KAAN,CAAYG,YAFkB;AAGvCC,IAAAA,OAAO,EAAE;AAH8B,KAIpC,+BAAcL,KAAK,CAACM,SAApB,EAA+BN,KAA/B,CAJoC;AAAA,CAAhB,CAAzB;;IAOMO,U;;;;;AAeJ,sBAAYP,KAAZ,EAAmB;AAAA;;AAAA;AACjB,8BAAMA,KAAN;AACA,UAAKQ,KAAL,GAAa;AACXC,MAAAA,OAAO,EAAE,MAAKC,eAAL,CAAqBV,KAArB;AADE,KAAb;AAFiB;AAKlB;;;;8CAEyBW,S,EAAW;AACnC,UACEA,SAAS,CAACC,WAAV,KAA0B,KAAKZ,KAAL,CAAWY,WAArC,IACAD,SAAS,CAACE,eAAV,KAA8B,KAAKb,KAAL,CAAWa,eADzC,IAEAF,SAAS,CAACG,KAAV,KAAoB,KAAKd,KAAL,CAAWc,KAHjC,EAIE;AACA,aAAKC,QAAL,CAAc;AAACN,UAAAA,OAAO,EAAE,KAAKC,eAAL,CAAqBC,SAArB;AAAV,SAAd;AACD;AACF;;;0CAEsD;AAAA,UAAtCC,WAAsC,QAAtCA,WAAsC;AAAA,UAAzBC,eAAyB,QAAzBA,eAAyB;AAAA,UAARC,KAAQ,QAARA,KAAQ;AACrD,UAAME,MAAM,GAAG,EAAf;;AACA,WAAK,IAAMC,GAAX,IAAkBL,WAAlB,EAA+B;AAC7B,YAAMM,UAAU,GAAGN,WAAW,CAACK,GAAD,CAA9B;;AACA,YAAIC,UAAJ,EAAgB;AACdF,UAAAA,MAAM,CAACC,GAAD,CAAN,mCACKJ,eAAe,CAACK,UAAD,CADpB;AAEEC,YAAAA,IAAI,EAAEL,KAAK,IAAIA,KAAK,CAACL,OAAN,CAAcS,UAAd;AAFjB;AAID;AACF;;AACD,aAAOF,MAAP;AACD;;;6BAEQ;AAAA,wBAC0B,KAAKhB,KAD/B;AAAA,UACAC,KADA,eACAA,KADA;AAAA,UACOmB,KADP,eACOA,KADP;AAAA,UACcC,QADd,eACcA,QADd;AAAA,UAEAZ,OAFA,GAEW,KAAKD,KAFhB,CAEAC,OAFA;AAIP,aACE,gCAAC,gBAAD;AAAkB,QAAA,KAAK,EAAER,KAAzB;AAAgC,QAAA,SAAS,EAAEmB,KAAK,CAACE;AAAjD,SACGD,QAAQ,CAAC;AAACpB,QAAAA,KAAK,EAALA,KAAD;AAAQQ,QAAAA,OAAO,EAAPA;AAAR,OAAD,CADX,CADF;AAKD;;;EAvDsBc,oB;;iCAAnBhB,U,eACe;AACjBa,EAAAA,KAAK,EAAEI,sBAAUC,MADA;AAEjBb,EAAAA,WAAW,EAAEY,sBAAUC,MAAV,CAAiBC,UAFb;AAGjBL,EAAAA,QAAQ,EAAEG,sBAAUG,IAAV,CAAeD,UAHR;AAMjBb,EAAAA,eAAe,EAAEW,sBAAUC,MANV;AAOjBX,EAAAA,KAAK,EAAEU,sBAAUC;AAPA,C;iCADflB,U,kBAWkB;AACpBa,EAAAA,KAAK,EAAE;AADa,C;;AA+CxB,IAAMQ,WAAW,GAAG,SAAdA,WAAc,CAAAC,GAAG;AAAA,SAAK;AAC1BhB,IAAAA,eAAe,EAAEgB,GAAG,CAACC,kBAAJ,EADS;AAE1BhB,IAAAA,KAAK,EAAEe,GAAG,CAACE,eAAJ;AAFmB,GAAL;AAAA,CAAvB;;eAKe,yBAAa;AAACH,EAAAA,WAAW,EAAXA,WAAD;AAAcI,EAAAA,SAAS,EAAE,2BAAUzB,UAAV;AAAzB,CAAb,C","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {evaluateStyle, withTheme} from '@streetscape.gl/monochrome';\nimport styled from '@emotion/styled';\n\nimport connectToLog from '../connect';\n\nconst WrapperComponent = styled.div(props => ({\n  ...props.theme.__reset__,\n  padding: props.theme.spacingSmall,\n  display: 'inline-block',\n  ...evaluateStyle(props.userStyle, props)\n}));\n\nclass BaseWidget extends PureComponent {\n  static propTypes = {\n    style: PropTypes.object,\n    streamNames: PropTypes.object.isRequired,\n    children: PropTypes.func.isRequired,\n\n    // From connected log\n    streamsMetadata: PropTypes.object,\n    frame: PropTypes.object\n  };\n\n  static defaultProps = {\n    style: {}\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      streams: this._extractStreams(props)\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (\n      nextProps.streamNames !== this.props.streamNames ||\n      nextProps.streamsMetadata !== this.props.streamsMetadata ||\n      nextProps.frame !== this.props.frame\n    ) {\n      this.setState({streams: this._extractStreams(nextProps)});\n    }\n  }\n\n  _extractStreams({streamNames, streamsMetadata, frame}) {\n    const result = {};\n    for (const key in streamNames) {\n      const streamName = streamNames[key];\n      if (streamName) {\n        result[key] = {\n          ...streamsMetadata[streamName],\n          data: frame && frame.streams[streamName]\n        };\n      }\n    }\n    return result;\n  }\n\n  render() {\n    const {theme, style, children} = this.props;\n    const {streams} = this.state;\n\n    return (\n      <WrapperComponent theme={theme} userStyle={style.wrapper}>\n        {children({theme, streams})}\n      </WrapperComponent>\n    );\n  }\n}\n\nconst getLogState = log => ({\n  streamsMetadata: log.getStreamsMetadata(),\n  frame: log.getCurrentFrame()\n});\n\nexport default connectToLog({getLogState, Component: withTheme(BaseWidget)});\n"],"file":"base-widget.js"}