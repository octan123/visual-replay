{"version":3,"sources":["../../../../src/components/log-viewer/perspective-popup.js"],"names":["React","Popup","withTheme","evaluateStyle","styled","ANCHOR_POSITION","top","x","y","bottom","left","right","PopupTip","div","props","position","width","height","margin","borderRadius","background","color","userStyle","PopupLine","borderLeftStyle","borderLeftWidth","borderColor","PopupContent","theme","__reset__","PerspectivePopup","positionType","anchorPosition","style","objectLabelTipSize","objectLabelColor","styleProps","tipSize","tipStyle","border","tipCircleStyle","tipLineStyle","objectLabelTip","objectLabelLine","_contentLoaded","objectLabelBody","children"],"mappings":"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","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React from 'react';\nimport {Popup} from 'react-map-gl';\nimport {withTheme, evaluateStyle} from '@streetscape.gl/monochrome';\n\nimport styled from '@emotion/styled';\n\n// Copied from 'react-map-gl/src/utils/dynamic-position.js'\nconst ANCHOR_POSITION = {\n  top: {x: 0.5, y: 0},\n  'top-left': {x: 0, y: 0},\n  'top-right': {x: 1, y: 0},\n  bottom: {x: 0.5, y: 1},\n  'bottom-left': {x: 0, y: 1},\n  'bottom-right': {x: 1, y: 1},\n  left: {x: 0, y: 0.5},\n  right: {x: 1, y: 0.5}\n};\n\nconst PopupTip = styled.div(props => ({\n  position: 'absolute',\n  width: 4,\n  height: 4,\n  margin: -2,\n  borderRadius: 2,\n  background: props.color,\n  ...evaluateStyle(props.userStyle, props)\n}));\n\nconst PopupLine = styled.div(props => ({\n  position: 'absolute',\n  borderLeftStyle: 'solid',\n  borderLeftWidth: 1,\n  borderColor: props.color,\n  ...evaluateStyle(props.userStyle, props)\n}));\n\nconst PopupContent = styled.div(props => ({\n  ...props.theme.__reset__,\n  background: props.color,\n  ...evaluateStyle(props.userStyle, props)\n}));\n\n/* Like Popup but deal with z */\nclass PerspectivePopup extends Popup {\n  _renderTip(positionType) {\n    const anchorPosition = ANCHOR_POSITION[positionType];\n    const {theme, style} = this.props;\n    const {objectLabelTipSize = 30, objectLabelColor = theme.background} = style;\n\n    const styleProps = {\n      ...this.props.styleProps,\n      theme,\n      color: objectLabelColor,\n      position: positionType\n    };\n\n    const tipSize = evaluateStyle(objectLabelTipSize, styleProps);\n\n    const tipStyle = {\n      width: tipSize,\n      height: tipSize,\n      position: 'relative',\n      border: 'none'\n    };\n\n    const tipCircleStyle = {};\n    const tipLineStyle = {};\n\n    switch (anchorPosition.x) {\n      case 0.5:\n        tipCircleStyle.left = '50%';\n        tipLineStyle.left = '50%';\n        break;\n      case 1:\n        tipCircleStyle.right = 0;\n        tipLineStyle.right = 0;\n        break;\n      case 0:\n      default:\n    }\n\n    switch (anchorPosition.y) {\n      case 0.5:\n        tipLineStyle.width = '100%';\n        tipCircleStyle.top = '50%';\n        tipLineStyle.top = '50%';\n        break;\n      case 1:\n        tipCircleStyle.bottom = 0;\n        tipLineStyle.height = '100%';\n        break;\n      case 0:\n      default:\n        tipLineStyle.height = '100%';\n    }\n\n    return (\n      <div key=\"tip\" className=\"mapboxgl-popup-tip\" style={tipStyle}>\n        <PopupTip style={tipCircleStyle} {...styleProps} userStyle={style.objectLabelTip} />\n        <PopupLine style={tipLineStyle} {...styleProps} userStyle={style.objectLabelLine} />\n      </div>\n    );\n  }\n\n  _renderContent() {\n    const {theme, styleProps, style} = this.props;\n\n    return (\n      <PopupContent\n        key=\"content\"\n        ref={this._contentLoaded}\n        className=\"mapboxgl-popup-content\"\n        theme={theme}\n        {...styleProps}\n        color={style.objectLabelColor}\n        userStyle={style.objectLabelBody}\n      >\n        {this.props.children}\n      </PopupContent>\n    );\n  }\n}\n\nexport default withTheme(PerspectivePopup);\n"],"file":"perspective-popup.js"}