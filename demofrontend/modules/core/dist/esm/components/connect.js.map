{"version":3,"sources":["../../../src/components/connect.js"],"names":["React","PureComponent","PropTypes","XVIZLoaderInterface","connectToLog","getLogState","Component","WrappedComponent","logVersion","setState","log","props","subscribe","_update","nextProps","nextLog","unsubscribe","otherProps","logState","instanceOf"],"mappings":";;;;;;;;;;;;;;AAoBA,OAAOA,KAAP,IAAeC,aAAf,QAAmC,OAAnC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AAEA,OAAOC,mBAAP,MAAgC,kCAAhC;AAEA,eAAe,SAASC,YAAT,OAAgD;AAAA,MAAzBC,WAAyB,QAAzBA,WAAyB;AAAA,MAAZC,SAAY,QAAZA,SAAY;;AAAA,MACvDC,gBADuD;AAAA;;AAAA;;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA,8DAMnD;AACNC,QAAAA,UAAU,EAAE,CAAC;AADP,OANmD;;AAAA,gEAqCjD,UAAAA,UAAU,EAAI;AACtB,cAAKC,QAAL,CAAc;AAACD,UAAAA,UAAU,EAAVA;AAAD,SAAd;AACD,OAvC0D;;AAAA;AAAA;;AAAA;AAAA;AAAA,0CAUvC;AAAA,YACXE,GADW,GACJ,KAAKC,KADD,CACXD,GADW;;AAElB,YAAIA,GAAJ,EAAS;AACPA,UAAAA,GAAG,CAACE,SAAJ,CAAc,KAAKC,OAAnB;AACD;AACF;AAf0D;AAAA;AAAA,gDAiBjCC,SAjBiC,EAiBtB;AAAA,YAC5BJ,GAD4B,GACrB,KAAKC,KADgB,CAC5BD,GAD4B;AAEnC,YAAMK,OAAO,GAAGD,SAAS,CAACJ,GAA1B;;AACA,YAAIA,GAAG,KAAKK,OAAZ,EAAqB;AACnB,cAAIL,GAAJ,EAAS;AACPA,YAAAA,GAAG,CAACM,WAAJ,CAAgB,KAAKH,OAArB;AACD;;AACD,cAAIE,OAAJ,EAAa;AACXA,YAAAA,OAAO,CAACH,SAAR,CAAkB,KAAKC,OAAvB;AACD;AACF;AACF;AA5B0D;AAAA;AAAA,6CA8BpC;AAAA,YACdH,GADc,GACP,KAAKC,KADE,CACdD,GADc;;AAErB,YAAIA,GAAJ,EAAS;AACPA,UAAAA,GAAG,CAACM,WAAJ,CAAgB,KAAKH,OAArB;AACD;AACF;AAnC0D;AAAA;AAAA,+BAyClD;AAAA,0BACsB,KAAKF,KAD3B;AAAA,YACAD,GADA,eACAA,GADA;AAAA,YACQO,UADR;;AAGP,YAAMC,QAAQ,GAAGR,GAAG,IAAIL,WAAW,CAACK,GAAD,EAAMO,UAAN,CAAnC;AAEA,eAAO,oBAAC,SAAD,eAAeA,UAAf,EAA+BC,QAA/B;AAAyC,UAAA,GAAG,EAAER;AAA9C,WAAP;AACD;AA/C0D;;AAAA;AAAA,IAC9BT,aAD8B;;AAAA,kBACvDM,gBADuD,eAExC;AACjBG,IAAAA,GAAG,EAAER,SAAS,CAACiB,UAAV,CAAqBhB,mBAArB;AADY,GAFwC;;AAkD7D,SAAOI,gBAAP;AACD","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport XVIZLoaderInterface from '../loaders/xviz-loader-interface';\n\nexport default function connectToLog({getLogState, Component}) {\n  class WrappedComponent extends PureComponent {\n    static propTypes = {\n      log: PropTypes.instanceOf(XVIZLoaderInterface)\n    };\n\n    state = {\n      logVersion: -1\n    };\n\n    componentDidMount() {\n      const {log} = this.props;\n      if (log) {\n        log.subscribe(this._update);\n      }\n    }\n\n    componentWillReceiveProps(nextProps) {\n      const {log} = this.props;\n      const nextLog = nextProps.log;\n      if (log !== nextLog) {\n        if (log) {\n          log.unsubscribe(this._update);\n        }\n        if (nextLog) {\n          nextLog.subscribe(this._update);\n        }\n      }\n    }\n\n    componentWillUnmount() {\n      const {log} = this.props;\n      if (log) {\n        log.unsubscribe(this._update);\n      }\n    }\n\n    _update = logVersion => {\n      this.setState({logVersion});\n    };\n\n    render() {\n      const {log, ...otherProps} = this.props;\n\n      const logState = log && getLogState(log, otherProps);\n\n      return <Component {...otherProps} {...logState} log={log} />;\n    }\n  }\n\n  return WrappedComponent;\n}\n"],"file":"connect.js"}