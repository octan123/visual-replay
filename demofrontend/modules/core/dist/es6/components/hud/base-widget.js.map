{"version":3,"sources":["../../../../src/components/hud/base-widget.js"],"names":["React","PureComponent","PropTypes","evaluateStyle","withTheme","styled","connectToLog","WrapperComponent","div","props","theme","__reset__","padding","spacingSmall","display","userStyle","BaseWidget","constructor","state","streams","_extractStreams","componentWillReceiveProps","nextProps","streamNames","streamsMetadata","frame","setState","result","key","streamName","data","render","style","children","wrapper","object","isRequired","func","getLogState","log","getStreamsMetadata","getCurrentFrame","Component"],"mappings":"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","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\nimport {evaluateStyle, withTheme} from '@streetscape.gl/monochrome';\nimport styled from '@emotion/styled';\n\nimport connectToLog from '../connect';\n\nconst WrapperComponent = styled.div(props => ({\n  ...props.theme.__reset__,\n  padding: props.theme.spacingSmall,\n  display: 'inline-block',\n  ...evaluateStyle(props.userStyle, props)\n}));\n\nclass BaseWidget extends PureComponent {\n  static propTypes = {\n    style: PropTypes.object,\n    streamNames: PropTypes.object.isRequired,\n    children: PropTypes.func.isRequired,\n\n    // From connected log\n    streamsMetadata: PropTypes.object,\n    frame: PropTypes.object\n  };\n\n  static defaultProps = {\n    style: {}\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      streams: this._extractStreams(props)\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (\n      nextProps.streamNames !== this.props.streamNames ||\n      nextProps.streamsMetadata !== this.props.streamsMetadata ||\n      nextProps.frame !== this.props.frame\n    ) {\n      this.setState({streams: this._extractStreams(nextProps)});\n    }\n  }\n\n  _extractStreams({streamNames, streamsMetadata, frame}) {\n    const result = {};\n    for (const key in streamNames) {\n      const streamName = streamNames[key];\n      if (streamName) {\n        result[key] = {\n          ...streamsMetadata[streamName],\n          data: frame && frame.streams[streamName]\n        };\n      }\n    }\n    return result;\n  }\n\n  render() {\n    const {theme, style, children} = this.props;\n    const {streams} = this.state;\n\n    return (\n      <WrapperComponent theme={theme} userStyle={style.wrapper}>\n        {children({theme, streams})}\n      </WrapperComponent>\n    );\n  }\n}\n\nconst getLogState = log => ({\n  streamsMetadata: log.getStreamsMetadata(),\n  frame: log.getCurrentFrame()\n});\n\nexport default connectToLog({getLogState, Component: withTheme(BaseWidget)});\n"],"file":"base-widget.js"}