{"version":3,"sources":["../../../src/components/connect.js"],"names":["React","PureComponent","PropTypes","XVIZLoaderInterface","connectToLog","getLogState","Component","WrappedComponent","logVersion","setState","componentDidMount","log","props","subscribe","_update","componentWillReceiveProps","nextProps","nextLog","unsubscribe","componentWillUnmount","render","otherProps","logState","instanceOf"],"mappings":";;;AAoBA,OAAOA,KAAP,IAAeC,aAAf,QAAmC,OAAnC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AAEA,OAAOC,mBAAP,MAAgC,kCAAhC;AAEA,eAAe,SAASC,YAAT,CAAsB;AAACC,EAAAA,WAAD;AAAcC,EAAAA;AAAd,CAAtB,EAAgD;AAC7D,QAAMC,gBAAN,SAA+BN,aAA/B,CAA6C;AAAA;AAAA;;AAAA,qCAKnC;AACNO,QAAAA,UAAU,EAAE,CAAC;AADP,OALmC;;AAAA,uCAoCjCA,UAAU,IAAI;AACtB,aAAKC,QAAL,CAAc;AAACD,UAAAA;AAAD,SAAd;AACD,OAtC0C;AAAA;;AAS3CE,IAAAA,iBAAiB,GAAG;AAClB,YAAM;AAACC,QAAAA;AAAD,UAAQ,KAAKC,KAAnB;;AACA,UAAID,GAAJ,EAAS;AACPA,QAAAA,GAAG,CAACE,SAAJ,CAAc,KAAKC,OAAnB;AACD;AACF;;AAEDC,IAAAA,yBAAyB,CAACC,SAAD,EAAY;AACnC,YAAM;AAACL,QAAAA;AAAD,UAAQ,KAAKC,KAAnB;AACA,YAAMK,OAAO,GAAGD,SAAS,CAACL,GAA1B;;AACA,UAAIA,GAAG,KAAKM,OAAZ,EAAqB;AACnB,YAAIN,GAAJ,EAAS;AACPA,UAAAA,GAAG,CAACO,WAAJ,CAAgB,KAAKJ,OAArB;AACD;;AACD,YAAIG,OAAJ,EAAa;AACXA,UAAAA,OAAO,CAACJ,SAAR,CAAkB,KAAKC,OAAvB;AACD;AACF;AACF;;AAEDK,IAAAA,oBAAoB,GAAG;AACrB,YAAM;AAACR,QAAAA;AAAD,UAAQ,KAAKC,KAAnB;;AACA,UAAID,GAAJ,EAAS;AACPA,QAAAA,GAAG,CAACO,WAAJ,CAAgB,KAAKJ,OAArB;AACD;AACF;;AAMDM,IAAAA,MAAM,GAAG;AACP,0BAA6B,KAAKR,KAAlC;AAAA,YAAM;AAACD,QAAAA;AAAD,OAAN;AAAA,YAAeU,UAAf;;AAEA,YAAMC,QAAQ,GAAGX,GAAG,IAAIN,WAAW,CAACM,GAAD,EAAMU,UAAN,CAAnC;AAEA,aAAO,oBAAC,SAAD,eAAeA,UAAf,EAA+BC,QAA/B;AAAyC,QAAA,GAAG,EAAEX;AAA9C,SAAP;AACD;;AA9C0C;;AADgB,kBACvDJ,gBADuD,eAExC;AACjBI,IAAAA,GAAG,EAAET,SAAS,CAACqB,UAAV,CAAqBpB,mBAArB;AADY,GAFwC;;AAkD7D,SAAOI,gBAAP;AACD","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport XVIZLoaderInterface from '../loaders/xviz-loader-interface';\n\nexport default function connectToLog({getLogState, Component}) {\n  class WrappedComponent extends PureComponent {\n    static propTypes = {\n      log: PropTypes.instanceOf(XVIZLoaderInterface)\n    };\n\n    state = {\n      logVersion: -1\n    };\n\n    componentDidMount() {\n      const {log} = this.props;\n      if (log) {\n        log.subscribe(this._update);\n      }\n    }\n\n    componentWillReceiveProps(nextProps) {\n      const {log} = this.props;\n      const nextLog = nextProps.log;\n      if (log !== nextLog) {\n        if (log) {\n          log.unsubscribe(this._update);\n        }\n        if (nextLog) {\n          nextLog.subscribe(this._update);\n        }\n      }\n    }\n\n    componentWillUnmount() {\n      const {log} = this.props;\n      if (log) {\n        log.unsubscribe(this._update);\n      }\n    }\n\n    _update = logVersion => {\n      this.setState({logVersion});\n    };\n\n    render() {\n      const {log, ...otherProps} = this.props;\n\n      const logState = log && getLogState(log, otherProps);\n\n      return <Component {...otherProps} {...logState} log={log} />;\n    }\n  }\n\n  return WrappedComponent;\n}\n"],"file":"connect.js"}