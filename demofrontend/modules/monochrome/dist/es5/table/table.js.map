{"version":3,"sources":["../../../src/table/table.js"],"names":["Table","props","columns","setState","_forceUpdate","sortFunc","rows","formatRows","state","sort","_list","_cache","clearAll","forceUpdateGrid","key","parent","index","style","_renderRow","_formatRows","CellMeasurerCache","fixedWidth","prevProps","map","row","rowIndex","srcObject","data","children","id","String","renderCell","theme","userStyle","width","height","list","length","rowHeight","_renderRowMeasurer","renderHeader","wrapper","_onSort","_onHeaderResize","body","_renderBody","bind","PureComponent","PropTypes","oneOfType","string","number","object","array","func","column","name","value"],"mappings":"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","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\nimport List from 'react-virtualized/dist/commonjs/List';\nimport CellMeasurer, {CellMeasurerCache} from 'react-virtualized/dist/commonjs/CellMeasurer';\n\nimport {withTheme} from '../shared/theme';\nimport memoize from '../utils/memoize';\n\nimport TableHeader from './table-header';\nimport TableRow from './table-row';\nimport {WrapperComponent, TableBody} from './styled-components';\n\nexport class Table extends PureComponent {\n  static propTypes = {\n    width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    height: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    style: PropTypes.object,\n    columns: PropTypes.array,\n    rows: PropTypes.array,\n    renderHeader: PropTypes.func,\n    renderCell: PropTypes.func\n  };\n\n  static defaultProps = {\n    width: '100%',\n    height: 400,\n    style: {},\n    rows: [],\n    renderHeader: ({column}) => column.name,\n    renderCell: ({value}) => (value === null ? null : String(value))\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      columns: null,\n      sortFunc: null\n    };\n\n    this.formatRows = memoize(this._formatRows);\n    this._cache = new CellMeasurerCache({fixedWidth: true});\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.rows !== prevProps.rows) {\n      this._forceUpdate();\n    }\n  }\n\n  _formatRows(rows, sortFunc) {\n    rows = rows.map((row, rowIndex) => ({\n      srcObject: row,\n      data: row.data,\n      children: row.children,\n      id: String(rowIndex)\n    }));\n\n    if (sortFunc) {\n      rows.sort(sortFunc);\n    }\n\n    return rows;\n  }\n\n  _onHeaderResize = columns => {\n    this.setState({columns}, this._forceUpdate);\n  };\n\n  _onSort = sortFunc => {\n    const rows = this.formatRows(this.props.rows, this.state.sortFunc);\n\n    if (sortFunc) {\n      rows.sort(sortFunc);\n    }\n\n    this.setState({sortFunc});\n    this._forceUpdate();\n  };\n\n  _forceUpdate = () => {\n    if (this._list) {\n      this._cache.clearAll();\n      this._list.forceUpdateGrid();\n    }\n  };\n\n  _renderRow({key, index, style}) {\n    const {renderCell, theme, style: userStyle} = this.props;\n    const rows = this.formatRows(this.props.rows, this.state.sortFunc);\n    const row = rows[index];\n\n    return (\n      <TableRow\n        key={key}\n        id={row.id}\n        index={index}\n        data={row}\n        style={style}\n        theme={theme}\n        userStyle={userStyle}\n        renderCell={renderCell}\n        columns={this.state.columns}\n      />\n    );\n  }\n\n  _renderRowMeasurer = ({key, parent, index, style}) => {\n    return (\n      <CellMeasurer cache={this._cache} parent={parent} key={key} rowIndex={index} collumnIndex={0}>\n        {() => this._renderRow({key, index, style})}\n      </CellMeasurer>\n    );\n  };\n\n  // AutoSizer is a pure component. By default child function is only called if dimensions change.\n  // Rebind this function every render to respond to state change\n  _renderBody({width, height}) {\n    const {columns} = this.state;\n    const rows = this.formatRows(this.props.rows, this.state.sortFunc);\n\n    if (!columns) {\n      return null;\n    }\n\n    return (\n      <List\n        ref={list => {\n          this._list = list;\n        }}\n        tabIndex={null}\n        height={height}\n        rowCount={rows.length}\n        rowHeight={this._cache.rowHeight}\n        rowRenderer={this._renderRowMeasurer}\n        width={width}\n      />\n    );\n  }\n\n  render() {\n    const {theme, width, height, style, columns, renderHeader} = this.props;\n\n    return (\n      <WrapperComponent style={{width, height}} theme={theme} userStyle={style.wrapper}>\n        <TableHeader\n          theme={theme}\n          userStyle={style}\n          columns={columns}\n          renderHeader={renderHeader}\n          onSort={this._onSort}\n          onResize={this._onHeaderResize}\n        />\n\n        <TableBody theme={theme} userStyle={style.body}>\n          <AutoSizer>{this._renderBody.bind(this)}</AutoSizer>\n        </TableBody>\n      </WrapperComponent>\n    );\n  }\n}\n\nexport default withTheme(Table);\n"],"file":"table.js"}