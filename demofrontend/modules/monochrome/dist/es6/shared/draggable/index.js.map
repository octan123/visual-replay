{"version":3,"sources":["../../../../src/shared/draggable/index.js"],"names":["React","PureComponent","PropTypes","styled","evaluateStyle","ContainerComponent","div","props","margin","tolerance","padding","cursor","isActive","isEnabled","userStyle","BACKDROP_STYLES","position","zIndex","top","left","width","height","noop","Draggable","constructor","evt","offset","state","dragStartPos","hasDragged","result","srcEvent","x","clientX","y","clientY","offsetX","offsetY","deltaX","deltaY","stopPropagation","_element","getBoundingClientRect","eventData","_getEventData","setState","isMouseDown","onDragStart","onDrag","onDragEnd","render","style","className","ref","_onMouseDown","_onMouseMove","_onMouseUp","children","string","object","number","bool","func"],"mappings":"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","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport styled from '@emotion/styled';\nimport {evaluateStyle} from '../theme';\n\nconst ContainerComponent = styled.div(props => ({\n  margin: -props.tolerance,\n  padding: props.tolerance,\n  cursor: props.isActive ? 'grabbing' : props.isEnabled ? 'grab' : 'inherit',\n\n  ...evaluateStyle(props.userStyle, props)\n}));\n\nconst BACKDROP_STYLES = {\n  position: 'fixed',\n  zIndex: 999,\n  top: 0,\n  left: 0,\n  width: '100%',\n  height: '100%'\n};\n\nfunction noop() {}\n\n/**\n * @class\n */\nexport default class Draggable extends PureComponent {\n  static propTypes = {\n    // container\n    className: PropTypes.string,\n    // config\n    style: PropTypes.object,\n    tolerance: PropTypes.number,\n    isEnabled: PropTypes.bool,\n    // callbacks\n    onDragStart: PropTypes.func,\n    onDrag: PropTypes.func,\n    onDragEnd: PropTypes.func\n  };\n\n  static defaultProps = {\n    className: '',\n    isEnabled: true,\n    tolerance: 0,\n    onDragStart: noop,\n    onDrag: noop,\n    onDragEnd: noop\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isMouseDown: false,\n      dragStartPos: null,\n      hasDragged: false\n    };\n  }\n\n  _getEventData = (evt, offset = this.state.offset) => {\n    const {dragStartPos, hasDragged} = this.state;\n    const result = {\n      srcEvent: evt,\n      x: evt.clientX,\n      y: evt.clientY,\n      offsetX: evt.clientX - offset.left,\n      offsetY: evt.clientY - offset.top,\n      hasDragged\n    };\n    if (dragStartPos) {\n      result.deltaX = result.x - dragStartPos.x;\n      result.deltaY = result.y - dragStartPos.y;\n    } else {\n      result.deltaX = 0;\n      result.deltaY = 0;\n    }\n    return result;\n  };\n\n  _onMouseDown = evt => {\n    if (!this.props.isEnabled) {\n      return;\n    }\n    evt.stopPropagation();\n\n    const offset = this._element.getBoundingClientRect();\n    const eventData = this._getEventData(evt, offset);\n\n    this.setState({\n      isMouseDown: true,\n      hasDragged: false,\n      offset,\n      dragStartPos: {x: eventData.x, y: eventData.y}\n    });\n    this.props.onDragStart(eventData);\n  };\n\n  _onMouseMove = evt => {\n    if (!this.props.isEnabled) {\n      return;\n    }\n    evt.stopPropagation();\n\n    if (this.state.isMouseDown) {\n      const eventData = this._getEventData(evt);\n      const {deltaX, deltaY} = eventData;\n\n      if (!this.state.hasDragged) {\n        if (deltaX || deltaY) {\n          this.setState({hasDragged: true});\n        } else {\n          return;\n        }\n      }\n      this.props.onDrag(eventData);\n    }\n  };\n\n  _onMouseUp = evt => {\n    if (this.state.isMouseDown) {\n      this.setState({\n        isMouseDown: false,\n        dragStartPos: null\n      });\n      this.props.onDragEnd(this._getEventData(evt));\n    }\n  };\n\n  render() {\n    const {style, isEnabled, className, tolerance} = this.props;\n    const {isMouseDown} = this.state;\n\n    return (\n      <ContainerComponent\n        className={className}\n        ref={ref => {\n          this._element = ref;\n        }}\n        tolerance={tolerance}\n        isEnabled={isEnabled}\n        isActive={isMouseDown}\n        userStyle={style}\n        onMouseDown={this._onMouseDown}\n        onMouseMove={this._onMouseMove}\n        onMouseLeave={this._onMouseUp}\n        onMouseUp={this._onMouseUp}\n      >\n        {isMouseDown && <div style={BACKDROP_STYLES} />}\n\n        {this.props.children}\n      </ContainerComponent>\n    );\n  }\n}\n"],"file":"index.js"}