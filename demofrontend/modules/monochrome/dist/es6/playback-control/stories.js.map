{"version":3,"sources":["../../../src/playback-control/stories.js"],"names":["React","Component","boolean","storiesOf","withReadme","README","PlaybackControl","Dropdown","PLAYBACK_SPEEDS","CLIP_LENGTH","MARKERS","startTime","endTime","style","background","BUFFER_RANGE","PlaybackControlExample","isPlaying","currentTime","speed","setState","_onUpdateTimer","Date","now","window","cancelAnimationFrame","_timer","Number","lastUpdateTimestamp","timestamp","state","timeElapsed","newTime","requestAnimationFrame","bind","render","compact","showSpeedOptions","showMarkers","props","_onPlay","_onPause","_onSeek","flexGrow","String","_updateSpeed","module","addDecorator","add"],"mappings":"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","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n/* Playback control example */\n/* global window */\nimport React, {Component} from 'react';\nimport {boolean} from '@storybook/addon-knobs';\nimport {storiesOf} from '@storybook/react';\nimport {withReadme} from 'storybook-readme';\n\nimport README from './README.md';\nimport PlaybackControl from './index';\nimport {Dropdown} from '../shared';\n\nconst PLAYBACK_SPEEDS = {\n  '-1': 'Reverse',\n  0.5: '0.5x Speed',\n  1: 'Normal',\n  2: '2x Speed'\n};\n\nconst CLIP_LENGTH = 20;\n\nconst MARKERS = [\n  {startTime: 0, endTime: 3, style: {background: '#ccc'}},\n  {startTime: 3, endTime: 14, style: {background: '#0a9'}},\n  {startTime: 14, endTime: 20, style: {background: '#fa0'}}\n];\n\nconst BUFFER_RANGE = [{startTime: 0, endTime: 15}];\n\nclass PlaybackControlExample extends Component {\n  state = {\n    isPlaying: false,\n    currentTime: 0,\n    speed: 1\n  };\n\n  _timer = null;\n\n  // A simple timer that simulates video playback\n  _onUpdateTimer(lastUpdateTimestamp) {\n    window.cancelAnimationFrame(this._timer);\n\n    const timestamp = Date.now();\n    const {currentTime, speed} = this.state;\n\n    // Update current time\n    const timeElapsed = (timestamp - lastUpdateTimestamp) / 1000;\n    // Loop around the clip\n    const newTime = (timeElapsed * speed + currentTime + CLIP_LENGTH) % CLIP_LENGTH;\n    this.setState({currentTime: newTime});\n\n    this._timer = window.requestAnimationFrame(this._onUpdateTimer.bind(this, timestamp));\n  }\n\n  _onPlay = () => {\n    this.setState({isPlaying: true});\n    this._onUpdateTimer(Date.now());\n  };\n\n  _onPause = () => {\n    this.setState({isPlaying: false});\n    window.cancelAnimationFrame(this._timer);\n  };\n\n  _onSeek = currentTime => {\n    this.setState({currentTime});\n  };\n\n  _updateSpeed = speed => {\n    this.setState({speed: Number(speed)});\n  };\n\n  render() {\n    const {compact = false, showSpeedOptions = false, showMarkers = false} = this.props;\n    const {isPlaying, currentTime, speed} = this.state;\n\n    return (\n      <PlaybackControl\n        compact={compact}\n        currentTime={currentTime}\n        startTime={0}\n        endTime={CLIP_LENGTH}\n        isPlaying={isPlaying}\n        markers={showMarkers ? MARKERS : []}\n        bufferRange={showMarkers ? BUFFER_RANGE : []}\n        onPlay={this._onPlay}\n        onPause={this._onPause}\n        onSeek={this._onSeek}\n      >\n        {showSpeedOptions && <div style={{flexGrow: 1}} />}\n        {showSpeedOptions && (\n          <Dropdown\n            key=\"speed-selector\"\n            className=\"speed-selector\"\n            data={PLAYBACK_SPEEDS}\n            value={String(speed)}\n            onChange={this._updateSpeed}\n          />\n        )}\n      </PlaybackControl>\n    );\n  }\n}\n\nstoriesOf('PlaybackControl', module)\n  .addDecorator(withReadme(README))\n  .add('Basic example', () => <PlaybackControlExample compact={boolean('compact', false)} />)\n  .add('Markers', () => (\n    <PlaybackControlExample showMarkers={true} compact={boolean('compact', false)} />\n  ))\n  .add('Custom controls', () => <PlaybackControlExample showSpeedOptions={true} />);\n"],"file":"stories.js"}