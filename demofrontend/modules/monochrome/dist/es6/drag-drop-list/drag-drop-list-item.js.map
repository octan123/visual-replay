{"version":3,"sources":["../../../src/drag-drop-list/drag-drop-list-item.js"],"names":["React","PropTypes","Draggable","ListItemContainer","ListItemTitle","ListItemPlaceholder","noop","TRANSITION","DragDropListItem","PureComponent","isHovered","isDragging","isActive","width","height","dragStartOffset","left","top","dragPos","deltaX","deltaY","setState","evt","container","_container","offsetWidth","offsetHeight","getBoundingClientRect","props","onDragStart","onDragMove","removed","onDragEnd","_timer","window","setTimeout","componentWillUnmount","clearTimeout","getBoundingBox","renderTitle","title","renderMover","children","_onDragStart","_onDragMove","_onDragEnd","renderContent","className","theme","style","state","styleProps","isRemoved","itemStyle","item","_onMouseEnter","_onMouseLeave","render","placeholderStyle","ref","placeholder","string","oneOfType","node","bool","object","isRequired","func"],"mappings":"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","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n// @flow\n/* global window */\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\n\nimport Draggable from '../shared/draggable';\nimport {ListItemContainer, ListItemTitle, ListItemPlaceholder} from './styled-components';\n\nconst noop = () => {};\n\nconst TRANSITION = 300;\n\nexport type DragPos = {\n  deltaX: number,\n  deltaY: number\n};\nexport type Prop = {\n  className: string,\n  title: React.Node | string,\n  removed: boolean,\n  onDragStart: Function,\n  onDragMove: Function,\n  onDragEnd: Function,\n  children?: React.Node\n};\nexport type State = {\n  isDragging: boolean,\n  isActive: boolean,\n  width: number,\n  height: number,\n  dragStartOffset: {left: number, top: number},\n  dragPos: DragPos\n};\nexport default class DragDropListItem extends React.PureComponent<Prop, State> {\n  static propTypes = {\n    className: PropTypes.string,\n    title: PropTypes.oneOfType([PropTypes.node, PropTypes.string]),\n    removed: PropTypes.bool,\n    style: PropTypes.object.isRequired,\n    onDragStart: PropTypes.func,\n    onDragMove: PropTypes.func,\n    onDragEnd: PropTypes.func\n  };\n\n  static defaultProps = {\n    className: '',\n    removed: false,\n    onDragStart: noop,\n    onDragMove: noop,\n    onDragEnd: noop\n  };\n\n  state: State = {\n    isHovered: false,\n    isDragging: false,\n    isActive: false,\n    width: 0,\n    height: 0,\n    dragStartOffset: {left: 0, top: 0},\n    dragPos: {deltaX: 0, deltaY: 0}\n  };\n\n  componentWillUnmount() {\n    window.clearTimeout(this._timer);\n  }\n\n  _container: any;\n\n  _timer = null;\n\n  getBoundingBox() {\n    return this._container.getBoundingClientRect();\n  }\n\n  _onMouseEnter = () => this.setState({isHovered: true});\n\n  _onMouseLeave = () => this.setState({isHovered: false});\n\n  _onDragStart = (evt: DragPos) => {\n    const container = this._container;\n\n    this.setState({\n      isDragging: true,\n      isActive: true,\n      width: container.offsetWidth,\n      height: container.offsetHeight,\n      dragStartOffset: container.getBoundingClientRect(),\n      dragPos: evt\n    });\n\n    this.props.onDragStart(evt);\n  };\n\n  _onDragMove = (evt: DragPos) => {\n    this.setState({dragPos: evt});\n    this.props.onDragMove(evt);\n  };\n\n  _onDragEnd = (evt: DragPos) => {\n    this.setState({\n      isDragging: false,\n      dragStartOffset: this._container.getBoundingClientRect(),\n      dragPos: {deltaX: 0, deltaY: 0}\n    });\n\n    if (this.props.removed) {\n      // No transition for removed items\n      this.props.onDragEnd(evt);\n    } else {\n      // Wait for transition to be done, then remove z-index and drop shadow\n      this._timer = window.setTimeout(() => {\n        this.setState({isActive: false});\n        this.props.onDragEnd(evt);\n      }, TRANSITION);\n    }\n  };\n\n  renderTitle() {\n    const {title} = this.props;\n    return typeof title === 'function' ? title() : title;\n  }\n\n  renderMover(children) {\n    return (\n      <Draggable\n        onDragStart={this._onDragStart}\n        onDrag={this._onDragMove}\n        onDragEnd={this._onDragEnd}\n      >\n        {children}\n      </Draggable>\n    );\n  }\n\n  renderContent() {\n    const {className, removed, theme, style} = this.props;\n    const {isHovered, isDragging, isActive, width, height, dragPos, dragStartOffset} = this.state;\n\n    const styleProps = {\n      theme,\n      isRemoved: removed,\n      isHovered,\n      isDragging,\n      isActive\n    };\n\n    const title = this.renderTitle();\n\n    const itemStyle = isActive\n      ? {\n          left: dragStartOffset.left + dragPos.deltaX,\n          top: dragStartOffset.top + dragPos.deltaY,\n          width,\n          height\n        }\n      : null;\n\n    return title ? (\n      <ListItemContainer\n        className={className}\n        {...styleProps}\n        userStyle={style.item}\n        style={itemStyle}\n      >\n        {this.renderMover(\n          <ListItemTitle\n            {...styleProps}\n            userStyle={style.title}\n            onMouseEnter={this._onMouseEnter}\n            onMouseLeave={this._onMouseLeave}\n          >\n            {title}\n          </ListItemTitle>\n        )}\n        {this.props.children}\n      </ListItemContainer>\n    ) : (\n      this.renderMover(\n        <ListItemContainer\n          onMouseEnter={this._onMouseEnter}\n          onMouseLeave={this._onMouseLeave}\n          className={className}\n          {...styleProps}\n          userStyle={style.item}\n          style={itemStyle}\n        >\n          {this.props.children}\n        </ListItemContainer>\n      )\n    );\n  }\n\n  render() {\n    const {theme, removed, style} = this.props;\n    const {isHovered, isDragging, isActive, width, height} = this.state;\n\n    const styleProps = {\n      theme,\n      isRemoved: removed,\n      isHovered,\n      isDragging,\n      isActive\n    };\n\n    const placeholderStyle = {\n      width,\n      height: removed ? 0 : height\n    };\n\n    return (\n      <div\n        ref={ref => {\n          this._container = ref;\n        }}\n      >\n        {this.renderContent()}\n        {isActive && (\n          <ListItemPlaceholder\n            {...styleProps}\n            userStyle={style.placeholder}\n            style={placeholderStyle}\n          />\n        )}\n      </div>\n    );\n  }\n}\n"],"file":"drag-drop-list-item.js"}