{"version":3,"sources":["../../../../src/shared/draggable/index.js"],"names":["React","PureComponent","PropTypes","styled","evaluateStyle","ContainerComponent","div","props","margin","tolerance","padding","cursor","isActive","isEnabled","userStyle","BACKDROP_STYLES","position","zIndex","top","left","width","height","noop","Draggable","evt","offset","state","dragStartPos","hasDragged","result","srcEvent","x","clientX","y","clientY","offsetX","offsetY","deltaX","deltaY","stopPropagation","_element","getBoundingClientRect","eventData","_getEventData","setState","isMouseDown","onDragStart","onDrag","onDragEnd","style","className","ref","_onMouseDown","_onMouseMove","_onMouseUp","children","string","object","number","bool","func"],"mappings":"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","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport styled from '@emotion/styled';\nimport {evaluateStyle} from '../theme';\n\nconst ContainerComponent = styled.div(props => ({\n  margin: -props.tolerance,\n  padding: props.tolerance,\n  cursor: props.isActive ? 'grabbing' : props.isEnabled ? 'grab' : 'inherit',\n\n  ...evaluateStyle(props.userStyle, props)\n}));\n\nconst BACKDROP_STYLES = {\n  position: 'fixed',\n  zIndex: 999,\n  top: 0,\n  left: 0,\n  width: '100%',\n  height: '100%'\n};\n\nfunction noop() {}\n\n/**\n * @class\n */\nexport default class Draggable extends PureComponent {\n  static propTypes = {\n    // container\n    className: PropTypes.string,\n    // config\n    style: PropTypes.object,\n    tolerance: PropTypes.number,\n    isEnabled: PropTypes.bool,\n    // callbacks\n    onDragStart: PropTypes.func,\n    onDrag: PropTypes.func,\n    onDragEnd: PropTypes.func\n  };\n\n  static defaultProps = {\n    className: '',\n    isEnabled: true,\n    tolerance: 0,\n    onDragStart: noop,\n    onDrag: noop,\n    onDragEnd: noop\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isMouseDown: false,\n      dragStartPos: null,\n      hasDragged: false\n    };\n  }\n\n  _getEventData = (evt, offset = this.state.offset) => {\n    const {dragStartPos, hasDragged} = this.state;\n    const result = {\n      srcEvent: evt,\n      x: evt.clientX,\n      y: evt.clientY,\n      offsetX: evt.clientX - offset.left,\n      offsetY: evt.clientY - offset.top,\n      hasDragged\n    };\n    if (dragStartPos) {\n      result.deltaX = result.x - dragStartPos.x;\n      result.deltaY = result.y - dragStartPos.y;\n    } else {\n      result.deltaX = 0;\n      result.deltaY = 0;\n    }\n    return result;\n  };\n\n  _onMouseDown = evt => {\n    if (!this.props.isEnabled) {\n      return;\n    }\n    evt.stopPropagation();\n\n    const offset = this._element.getBoundingClientRect();\n    const eventData = this._getEventData(evt, offset);\n\n    this.setState({\n      isMouseDown: true,\n      hasDragged: false,\n      offset,\n      dragStartPos: {x: eventData.x, y: eventData.y}\n    });\n    this.props.onDragStart(eventData);\n  };\n\n  _onMouseMove = evt => {\n    if (!this.props.isEnabled) {\n      return;\n    }\n    evt.stopPropagation();\n\n    if (this.state.isMouseDown) {\n      const eventData = this._getEventData(evt);\n      const {deltaX, deltaY} = eventData;\n\n      if (!this.state.hasDragged) {\n        if (deltaX || deltaY) {\n          this.setState({hasDragged: true});\n        } else {\n          return;\n        }\n      }\n      this.props.onDrag(eventData);\n    }\n  };\n\n  _onMouseUp = evt => {\n    if (this.state.isMouseDown) {\n      this.setState({\n        isMouseDown: false,\n        dragStartPos: null\n      });\n      this.props.onDragEnd(this._getEventData(evt));\n    }\n  };\n\n  render() {\n    const {style, isEnabled, className, tolerance} = this.props;\n    const {isMouseDown} = this.state;\n\n    return (\n      <ContainerComponent\n        className={className}\n        ref={ref => {\n          this._element = ref;\n        }}\n        tolerance={tolerance}\n        isEnabled={isEnabled}\n        isActive={isMouseDown}\n        userStyle={style}\n        onMouseDown={this._onMouseDown}\n        onMouseMove={this._onMouseMove}\n        onMouseLeave={this._onMouseUp}\n        onMouseUp={this._onMouseUp}\n      >\n        {isMouseDown && <div style={BACKDROP_STYLES} />}\n\n        {this.props.children}\n      </ContainerComponent>\n    );\n  }\n}\n"],"file":"index.js"}