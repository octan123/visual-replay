{"version":3,"sources":["../../../src/drag-drop-list/drag-drop-list-item.js"],"names":["React","PropTypes","Draggable","ListItemContainer","ListItemTitle","ListItemPlaceholder","noop","TRANSITION","DragDropListItem","isHovered","isDragging","isActive","width","height","dragStartOffset","left","top","dragPos","deltaX","deltaY","setState","evt","container","_container","offsetWidth","offsetHeight","getBoundingClientRect","props","onDragStart","onDragMove","removed","onDragEnd","_timer","window","setTimeout","clearTimeout","title","children","_onDragStart","_onDragMove","_onDragEnd","className","theme","style","state","styleProps","isRemoved","renderTitle","itemStyle","item","renderMover","_onMouseEnter","_onMouseLeave","placeholderStyle","ref","renderContent","placeholder","PureComponent","string","oneOfType","node","bool","object","isRequired","func"],"mappings":"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","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n// @flow\n/* global window */\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\n\nimport Draggable from '../shared/draggable';\nimport {ListItemContainer, ListItemTitle, ListItemPlaceholder} from './styled-components';\n\nconst noop = () => {};\n\nconst TRANSITION = 300;\n\nexport type DragPos = {\n  deltaX: number,\n  deltaY: number\n};\nexport type Prop = {\n  className: string,\n  title: React.Node | string,\n  removed: boolean,\n  onDragStart: Function,\n  onDragMove: Function,\n  onDragEnd: Function,\n  children?: React.Node\n};\nexport type State = {\n  isDragging: boolean,\n  isActive: boolean,\n  width: number,\n  height: number,\n  dragStartOffset: {left: number, top: number},\n  dragPos: DragPos\n};\nexport default class DragDropListItem extends React.PureComponent<Prop, State> {\n  static propTypes = {\n    className: PropTypes.string,\n    title: PropTypes.oneOfType([PropTypes.node, PropTypes.string]),\n    removed: PropTypes.bool,\n    style: PropTypes.object.isRequired,\n    onDragStart: PropTypes.func,\n    onDragMove: PropTypes.func,\n    onDragEnd: PropTypes.func\n  };\n\n  static defaultProps = {\n    className: '',\n    removed: false,\n    onDragStart: noop,\n    onDragMove: noop,\n    onDragEnd: noop\n  };\n\n  state: State = {\n    isHovered: false,\n    isDragging: false,\n    isActive: false,\n    width: 0,\n    height: 0,\n    dragStartOffset: {left: 0, top: 0},\n    dragPos: {deltaX: 0, deltaY: 0}\n  };\n\n  componentWillUnmount() {\n    window.clearTimeout(this._timer);\n  }\n\n  _container: any;\n\n  _timer = null;\n\n  getBoundingBox() {\n    return this._container.getBoundingClientRect();\n  }\n\n  _onMouseEnter = () => this.setState({isHovered: true});\n\n  _onMouseLeave = () => this.setState({isHovered: false});\n\n  _onDragStart = (evt: DragPos) => {\n    const container = this._container;\n\n    this.setState({\n      isDragging: true,\n      isActive: true,\n      width: container.offsetWidth,\n      height: container.offsetHeight,\n      dragStartOffset: container.getBoundingClientRect(),\n      dragPos: evt\n    });\n\n    this.props.onDragStart(evt);\n  };\n\n  _onDragMove = (evt: DragPos) => {\n    this.setState({dragPos: evt});\n    this.props.onDragMove(evt);\n  };\n\n  _onDragEnd = (evt: DragPos) => {\n    this.setState({\n      isDragging: false,\n      dragStartOffset: this._container.getBoundingClientRect(),\n      dragPos: {deltaX: 0, deltaY: 0}\n    });\n\n    if (this.props.removed) {\n      // No transition for removed items\n      this.props.onDragEnd(evt);\n    } else {\n      // Wait for transition to be done, then remove z-index and drop shadow\n      this._timer = window.setTimeout(() => {\n        this.setState({isActive: false});\n        this.props.onDragEnd(evt);\n      }, TRANSITION);\n    }\n  };\n\n  renderTitle() {\n    const {title} = this.props;\n    return typeof title === 'function' ? title() : title;\n  }\n\n  renderMover(children) {\n    return (\n      <Draggable\n        onDragStart={this._onDragStart}\n        onDrag={this._onDragMove}\n        onDragEnd={this._onDragEnd}\n      >\n        {children}\n      </Draggable>\n    );\n  }\n\n  renderContent() {\n    const {className, removed, theme, style} = this.props;\n    const {isHovered, isDragging, isActive, width, height, dragPos, dragStartOffset} = this.state;\n\n    const styleProps = {\n      theme,\n      isRemoved: removed,\n      isHovered,\n      isDragging,\n      isActive\n    };\n\n    const title = this.renderTitle();\n\n    const itemStyle = isActive\n      ? {\n          left: dragStartOffset.left + dragPos.deltaX,\n          top: dragStartOffset.top + dragPos.deltaY,\n          width,\n          height\n        }\n      : null;\n\n    return title ? (\n      <ListItemContainer\n        className={className}\n        {...styleProps}\n        userStyle={style.item}\n        style={itemStyle}\n      >\n        {this.renderMover(\n          <ListItemTitle\n            {...styleProps}\n            userStyle={style.title}\n            onMouseEnter={this._onMouseEnter}\n            onMouseLeave={this._onMouseLeave}\n          >\n            {title}\n          </ListItemTitle>\n        )}\n        {this.props.children}\n      </ListItemContainer>\n    ) : (\n      this.renderMover(\n        <ListItemContainer\n          onMouseEnter={this._onMouseEnter}\n          onMouseLeave={this._onMouseLeave}\n          className={className}\n          {...styleProps}\n          userStyle={style.item}\n          style={itemStyle}\n        >\n          {this.props.children}\n        </ListItemContainer>\n      )\n    );\n  }\n\n  render() {\n    const {theme, removed, style} = this.props;\n    const {isHovered, isDragging, isActive, width, height} = this.state;\n\n    const styleProps = {\n      theme,\n      isRemoved: removed,\n      isHovered,\n      isDragging,\n      isActive\n    };\n\n    const placeholderStyle = {\n      width,\n      height: removed ? 0 : height\n    };\n\n    return (\n      <div\n        ref={ref => {\n          this._container = ref;\n        }}\n      >\n        {this.renderContent()}\n        {isActive && (\n          <ListItemPlaceholder\n            {...styleProps}\n            userStyle={style.placeholder}\n            style={placeholderStyle}\n          />\n        )}\n      </div>\n    );\n  }\n}\n"],"file":"drag-drop-list-item.js"}