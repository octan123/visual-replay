{"version":3,"sources":["../../../src/form/form.js"],"names":["React","PureComponent","PropTypes","withTheme","ExpandedIcon","CollapsedIcon","Input","Container","Expander","SETTING_STYLES","position","Form","collapsed","settingName","newValue","props","onChange","newCollapsedState","state","setState","setting","value","isEnabled","level","theme","style","enabled","visible","children","isVisible","values","Boolean","input","title","_onChange","collapsible","expander","toggleCollapsed","iconCollapsed","iconExpanded","_renderSettings","settings","opts","Object","keys","child","_renderSetting","push","data","wrapper","object","isRequired","func"],"mappings":"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","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport {withTheme} from '../shared/theme';\nimport {ExpandedIcon, CollapsedIcon} from '../shared/icons';\n\nimport Input from './input';\nimport {Container, Expander} from './styled-components';\n\nconst SETTING_STYLES = {\n  position: 'relative'\n};\n\nclass Form extends PureComponent {\n  static propTypes = {\n    data: PropTypes.object.isRequired,\n    style: PropTypes.object,\n    values: PropTypes.object.isRequired,\n    onChange: PropTypes.func.isRequired\n  };\n\n  static defaultProps = {\n    style: {}\n  };\n\n  state = {\n    collapsed: {}\n  };\n\n  _onChange = (settingName, newValue) => {\n    this.props.onChange({\n      [settingName]: newValue\n    });\n  };\n\n  toggleCollapsed({settingName, collapsed}) {\n    const newCollapsedState = {...this.state.collapsed, [settingName]: !collapsed};\n    this.setState({collapsed: newCollapsedState});\n  }\n\n  /* eslint-disable complexity */\n  _renderSetting({settingName, setting, value, isEnabled = true, level}) {\n    const {theme, style} = this.props;\n    const {enabled = true, visible = true, children} = setting;\n    let isVisible;\n\n    if (typeof enabled === 'function') {\n      isEnabled = isEnabled && enabled(this.props.values);\n    } else {\n      isEnabled = isEnabled && Boolean(enabled);\n    }\n\n    if (typeof visible === 'function') {\n      isVisible = visible(this.props.values);\n    } else {\n      isVisible = Boolean(visible);\n    }\n\n    if (!isVisible) {\n      return null;\n    }\n\n    const collapsed =\n      typeof this.state.collapsed[settingName] !== 'undefined'\n        ? this.state.collapsed[settingName]\n        : false;\n\n    const input = (\n      <Input\n        key={settingName}\n        {...setting}\n        label={setting.title || settingName}\n        name={settingName}\n        value={value}\n        theme={theme}\n        style={style}\n        level={level}\n        isEnabled={isEnabled}\n        onChange={this._onChange}\n      />\n    );\n\n    if (!children) {\n      return input;\n    }\n\n    return (\n      <div key={settingName} style={SETTING_STYLES}>\n        {setting.collapsible && (\n          <Expander\n            theme={theme}\n            userStyle={style.expander}\n            onClick={() => this.toggleCollapsed({settingName, collapsed})}\n            isExpanded={!collapsed}\n          >\n            {collapsed\n              ? style.iconCollapsed || <CollapsedIcon />\n              : style.iconExpanded || <ExpandedIcon />}\n          </Expander>\n        )}\n        {input}\n        {!collapsed && this._renderSettings(children, {isEnabled, level: level + 1})}\n      </div>\n    );\n  }\n  /* eslint-enable complexity */\n\n  _renderSettings(settings, opts = {}) {\n    const {values} = this.props;\n    const children = [];\n    for (const settingName of Object.keys(settings)) {\n      const setting = settings[settingName];\n      const value = values[settingName];\n      const collapsed = this.state.collapsed[settingName];\n      const level = opts.level || 0;\n      const child = this._renderSetting({...opts, settingName, setting, value, collapsed, level});\n      children.push(child);\n    }\n    return children;\n  }\n\n  render() {\n    const {theme, style, data} = this.props;\n    return (\n      <Container theme={theme} userStyle={style.wrapper}>\n        {this._renderSettings(data)}\n      </Container>\n    );\n  }\n}\n\nexport default withTheme(Form);\n"],"file":"form.js"}