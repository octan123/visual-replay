{"version":3,"sources":["../../../src/table/table.js"],"names":["React","PureComponent","PropTypes","AutoSizer","List","CellMeasurer","CellMeasurerCache","withTheme","memoize","TableHeader","TableRow","WrapperComponent","TableBody","Table","props","columns","setState","_forceUpdate","sortFunc","rows","formatRows","state","sort","_list","_cache","clearAll","forceUpdateGrid","key","parent","index","style","_renderRow","_formatRows","fixedWidth","prevProps","map","row","rowIndex","srcObject","data","children","id","String","renderCell","theme","userStyle","width","height","list","length","rowHeight","_renderRowMeasurer","renderHeader","wrapper","_onSort","_onHeaderResize","body","_renderBody","bind","oneOfType","string","number","object","array","func","column","name","value"],"mappings":"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","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport React, {PureComponent} from 'react';\nimport PropTypes from 'prop-types';\n\nimport AutoSizer from 'react-virtualized/dist/commonjs/AutoSizer';\nimport List from 'react-virtualized/dist/commonjs/List';\nimport CellMeasurer, {CellMeasurerCache} from 'react-virtualized/dist/commonjs/CellMeasurer';\n\nimport {withTheme} from '../shared/theme';\nimport memoize from '../utils/memoize';\n\nimport TableHeader from './table-header';\nimport TableRow from './table-row';\nimport {WrapperComponent, TableBody} from './styled-components';\n\nexport class Table extends PureComponent {\n  static propTypes = {\n    width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    height: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    style: PropTypes.object,\n    columns: PropTypes.array,\n    rows: PropTypes.array,\n    renderHeader: PropTypes.func,\n    renderCell: PropTypes.func\n  };\n\n  static defaultProps = {\n    width: '100%',\n    height: 400,\n    style: {},\n    rows: [],\n    renderHeader: ({column}) => column.name,\n    renderCell: ({value}) => (value === null ? null : String(value))\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      columns: null,\n      sortFunc: null\n    };\n\n    this.formatRows = memoize(this._formatRows);\n    this._cache = new CellMeasurerCache({fixedWidth: true});\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.rows !== prevProps.rows) {\n      this._forceUpdate();\n    }\n  }\n\n  _formatRows(rows, sortFunc) {\n    rows = rows.map((row, rowIndex) => ({\n      srcObject: row,\n      data: row.data,\n      children: row.children,\n      id: String(rowIndex)\n    }));\n\n    if (sortFunc) {\n      rows.sort(sortFunc);\n    }\n\n    return rows;\n  }\n\n  _onHeaderResize = columns => {\n    this.setState({columns}, this._forceUpdate);\n  };\n\n  _onSort = sortFunc => {\n    const rows = this.formatRows(this.props.rows, this.state.sortFunc);\n\n    if (sortFunc) {\n      rows.sort(sortFunc);\n    }\n\n    this.setState({sortFunc});\n    this._forceUpdate();\n  };\n\n  _forceUpdate = () => {\n    if (this._list) {\n      this._cache.clearAll();\n      this._list.forceUpdateGrid();\n    }\n  };\n\n  _renderRow({key, index, style}) {\n    const {renderCell, theme, style: userStyle} = this.props;\n    const rows = this.formatRows(this.props.rows, this.state.sortFunc);\n    const row = rows[index];\n\n    return (\n      <TableRow\n        key={key}\n        id={row.id}\n        index={index}\n        data={row}\n        style={style}\n        theme={theme}\n        userStyle={userStyle}\n        renderCell={renderCell}\n        columns={this.state.columns}\n      />\n    );\n  }\n\n  _renderRowMeasurer = ({key, parent, index, style}) => {\n    return (\n      <CellMeasurer cache={this._cache} parent={parent} key={key} rowIndex={index} collumnIndex={0}>\n        {() => this._renderRow({key, index, style})}\n      </CellMeasurer>\n    );\n  };\n\n  // AutoSizer is a pure component. By default child function is only called if dimensions change.\n  // Rebind this function every render to respond to state change\n  _renderBody({width, height}) {\n    const {columns} = this.state;\n    const rows = this.formatRows(this.props.rows, this.state.sortFunc);\n\n    if (!columns) {\n      return null;\n    }\n\n    return (\n      <List\n        ref={list => {\n          this._list = list;\n        }}\n        tabIndex={null}\n        height={height}\n        rowCount={rows.length}\n        rowHeight={this._cache.rowHeight}\n        rowRenderer={this._renderRowMeasurer}\n        width={width}\n      />\n    );\n  }\n\n  render() {\n    const {theme, width, height, style, columns, renderHeader} = this.props;\n\n    return (\n      <WrapperComponent style={{width, height}} theme={theme} userStyle={style.wrapper}>\n        <TableHeader\n          theme={theme}\n          userStyle={style}\n          columns={columns}\n          renderHeader={renderHeader}\n          onSort={this._onSort}\n          onResize={this._onHeaderResize}\n        />\n\n        <TableBody theme={theme} userStyle={style.body}>\n          <AutoSizer>{this._renderBody.bind(this)}</AutoSizer>\n        </TableBody>\n      </WrapperComponent>\n    );\n  }\n}\n\nexport default withTheme(Table);\n"],"file":"table.js"}