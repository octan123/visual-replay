{"version":3,"sources":["../../../src/synchronizers/stream-synchronizer.js"],"names":["BaseSynchronizer","StreamSynchronizer","constructor","streamBuffer","opts","_empty","size","_getTimeRangeInReverse","startTime","endTime","slices","getTimeslices","start","end","reverse","streams","map","timeslice","filter","Boolean","links"],"mappings":"AAcA,OAAOA,gBAAP,MAA6B,qBAA7B;AAEA,eAAe,MAAMC,kBAAN,SAAiCD,gBAAjC,CAAkD;AAW/DE,EAAAA,WAAW,CAACC,YAAD,EAAeC,IAAf,EAAqB;AAC9B,UAAMA,IAAN;AAEA,SAAKD,YAAL,GAAoBA,YAApB;AACD;;AAEDE,EAAAA,MAAM,GAAG;AACP,WAAO,CAAC,KAAKF,YAAN,IAAsB,CAAC,KAAKA,YAAL,CAAkBG,IAAhD;AACD;;AASDC,EAAAA,sBAAsB,CAACC,SAAD,EAAYC,OAAZ,EAAqB;AACzC,UAAMC,MAAM,GAAG,KAAKP,YAAL,CAAkBQ,aAAlB,CAAgC;AAACC,MAAAA,KAAK,EAAEJ,SAAR;AAAmBK,MAAAA,GAAG,EAAEJ;AAAxB,KAAhC,EAAkEK,OAAlE,EAAf;AACA,WAAO;AACLC,MAAAA,OAAO,EAAEL,MAAM,CAACM,GAAP,CAAWC,SAAS,IAAIA,SAAS,CAACF,OAAlC,EAA2CG,MAA3C,CAAkDC,OAAlD,CADJ;AAELC,MAAAA,KAAK,EAAEV,MAAM,CAACM,GAAP,CAAWC,SAAS,IAAIA,SAAS,CAACG,KAAlC,EAAyCF,MAAzC,CAAgDC,OAAhD;AAFF,KAAP;AAID;;AAlC8D","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport BaseSynchronizer from './base-synchronizer';\n\nexport default class StreamSynchronizer extends BaseSynchronizer {\n  /**\n   * @classdesc\n   * Lets the application do synchronized walks through a set of time slices\n   * and allows the app to get the data object closes to a given time.\n   *\n   * @class\n   * @param Number startTime - The starting GPS time\n   * @param {XVIZStreamBuffer} streamBuffer - The stream buffer\n   * - Each timeslice object must contain a GPS timestamp\n   */\n  constructor(streamBuffer, opts) {\n    super(opts);\n\n    this.streamBuffer = streamBuffer;\n  }\n\n  _empty() {\n    return !this.streamBuffer || !this.streamBuffer.size;\n  }\n\n  /**\n   * Find and process stream data in the range (start, end] for process\n   * Returns a list of streams sorted by decending time\n   *\n   * @param Number startTime - The time to start from.\n   * @param Number endTime - The time to end at.\n   */\n  _getTimeRangeInReverse(startTime, endTime) {\n    const slices = this.streamBuffer.getTimeslices({start: startTime, end: endTime}).reverse();\n    return {\n      streams: slices.map(timeslice => timeslice.streams).filter(Boolean),\n      links: slices.map(timeslice => timeslice.links).filter(Boolean)\n    };\n  }\n}\n"],"file":"stream-synchronizer.js"}