{"version":3,"sources":["../../../src/config/xviz-config.js"],"names":["XVIZObjectCollection","XVIZObject","DEFAULT_XVIZ_CONFIG","supportedVersions","currentMajorVersion","pathDistanceThreshold","TIME_WINDOW","PLAYBACK_FRAME_RATE","STREAM_BLACKLIST","Set","preProcessPrimitive","primitive","ALLOW_MISSING_PRIMARY_POSE","DYNAMIC_STREAM_METADATA","TIMESTAMP_FORMAT","PRIMARY_POSE_STREAM","xvizConfig","Object","assign","setDefaultCollection","subscribers","subscribeXVIZConfigChange","func","push","notifySubscribers","forEach","sub","setXVIZConfig","config","Array","isArray","getXVIZConfig"],"mappings":"AAcA,OAAOA,oBAAP,MAAiC,mCAAjC;AACA,OAAOC,UAAP,MAAuB,wBAAvB;AAEA,IAAMC,mBAAmB,GAAG;AAE1BC,EAAAA,iBAAiB,EAAE,CAAC,CAAD,EAAI,CAAJ,CAFO;AAI1BC,EAAAA,mBAAmB,EAAE,CAJK;AAM1BC,EAAAA,qBAAqB,EAAE,GANG;AAW1BC,EAAAA,WAAW,EAAE,GAXa;AAa1BC,EAAAA,mBAAmB,EAAE,EAbK;AAe1BC,EAAAA,gBAAgB,EAAE,IAAIC,GAAJ,EAfQ;AAiB1BC,EAAAA,mBAAmB,EAAE,6BAAAC,SAAS;AAAA,WAAIA,SAAJ;AAAA,GAjBJ;AAmB1BC,EAAAA,0BAA0B,EAAE,KAnBF;AAqB1BC,EAAAA,uBAAuB,EAAE,KArBC;AAyB1BC,EAAAA,gBAAgB,EAAE,SAzBQ;AA0B1BC,EAAAA,mBAAmB,EAAE;AA1BK,CAA5B;AA6BA,IAAMC,UAAU,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBhB,mBAAlB,CAAnB;AAEAD,UAAU,CAACkB,oBAAX,CAAgC,IAAInB,oBAAJ,EAAhC;AAGA,IAAMoB,WAAW,GAAG,EAApB;AAGA,OAAO,SAASC,yBAAT,CAAmCC,IAAnC,EAAyC;AAC9CF,EAAAA,WAAW,CAACG,IAAZ,CAAiBD,IAAjB;AACD;;AAED,SAASE,iBAAT,GAA6B;AAC3BJ,EAAAA,WAAW,CAACK,OAAZ,CAAoB,UAAAC,GAAG;AAAA,WAAIA,GAAG,EAAP;AAAA,GAAvB;AACD;;AAGD,OAAO,SAASC,aAAT,CAAuBC,MAAvB,EAA+B;AACpCX,EAAAA,MAAM,CAACC,MAAP,CAAcF,UAAd,EAA0BY,MAA1B;;AAEA,MAAIC,KAAK,CAACC,OAAN,CAAcd,UAAU,CAACR,gBAAzB,CAAJ,EAAgD;AAC9CQ,IAAAA,UAAU,CAACR,gBAAX,GAA8B,IAAIC,GAAJ,CAAQO,UAAU,CAACR,gBAAnB,CAA9B;AACD;;AAEDgB,EAAAA,iBAAiB;AAClB;AAED,OAAO,SAASO,aAAT,GAAyB;AAC9B,SAAOf,UAAP;AACD","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport XVIZObjectCollection from '../objects/xviz-object-collection';\nimport XVIZObject from '../objects/xviz-object';\n\nconst DEFAULT_XVIZ_CONFIG = {\n  // Supported major XVIZ versions\n  supportedVersions: [1, 2],\n  // Number set upon parsing metadata\n  currentMajorVersion: 1,\n  // Filters out close vertices (work around for PathLayer issue)\n  pathDistanceThreshold: 0.1,\n\n  /* User configs */\n\n  // The time window to consider during synchronization\n  TIME_WINDOW: 0.4,\n  // The number of log frames to generate per second\n  PLAYBACK_FRAME_RATE: 10,\n  // The streams to block\n  STREAM_BLACKLIST: new Set(),\n  // Callback applied before normalize primitive\n  preProcessPrimitive: primitive => primitive,\n  // Allow scenarios where there is no /vehicle_pose stream\n  ALLOW_MISSING_PRIMARY_POSE: false,\n  // Auto backfill missing stream metadata\n  DYNAMIC_STREAM_METADATA: false,\n\n  /* Deprecated configs, do not use */\n\n  TIMESTAMP_FORMAT: 'seconds',\n  PRIMARY_POSE_STREAM: '/vehicle_pose'\n};\n\nconst xvizConfig = Object.assign({}, DEFAULT_XVIZ_CONFIG);\n\nXVIZObject.setDefaultCollection(new XVIZObjectCollection());\n\n// Allow subscribing to XVIZConfig changes\nconst subscribers = [];\n\n// func is a function that takes no arguments\nexport function subscribeXVIZConfigChange(func) {\n  subscribers.push(func);\n}\n\nfunction notifySubscribers() {\n  subscribers.forEach(sub => sub());\n}\n\n// CONFIG contains the static configuration of XVIZ (streams, how to postprocess etc)\nexport function setXVIZConfig(config) {\n  Object.assign(xvizConfig, config);\n\n  if (Array.isArray(xvizConfig.STREAM_BLACKLIST)) {\n    xvizConfig.STREAM_BLACKLIST = new Set(xvizConfig.STREAM_BLACKLIST);\n  }\n\n  notifySubscribers();\n}\n\nexport function getXVIZConfig() {\n  return xvizConfig;\n}\n"],"file":"xviz-config.js"}