{"version":3,"sources":["../../../src/cmds/dump.js"],"names":["addDataArgs","addMetadataArg","addCondensedArg","DumpXVIZ","DumpMode","openSource","dumpArgs","inArgs","command","args","dumpMode","oneline","ONELINE","condensed","CONDENSED","ALL","dump","mode","stack"],"mappings":"AAiBA,SAAQA,WAAR,EAAqBC,cAArB,EAAqCC,eAArC,QAA2D,eAA3D;AACA,SAAQC,QAAR,EAAkBC,QAAlB,QAAiC,SAAjC;AACA,SAAQC,UAAR,QAAyB,YAAzB;AAEA,OAAO,SAASC,QAAT,CAAkBC,MAAlB,EAA0B;AAC/B,SAAOA,MAAM,CAACC,OAAP,CACL,mBADK,EAEL,2BAFK,EAGL,UAAAC,IAAI,EAAI;AACNT,IAAAA,WAAW,CAACS,IAAD,CAAX;AACAR,IAAAA,cAAc,CAACQ,IAAD,EAAO,8BAAP,CAAd;AACAP,IAAAA,eAAe,CAACO,IAAD,EAAO,6BAAP,CAAf;AACD,GAPI,EAQL,UAAAA,IAAI,EAAI;AACND,IAAAA,OAAO,CAACC,IAAD,CAAP;AACD,GAVI,CAAP;AAYD;AAKD,eAAe,SAASD,OAAT,CAAiBC,IAAjB,EAAuB;AAEpC,MAAMC,QAAQ,GAAI,YAAM;AACtB,QAAID,IAAI,CAACE,OAAT,EAAkB;AAChB,aAAOP,QAAQ,CAACQ,OAAhB;AACD,KAFD,MAEO,IAAIH,IAAI,CAACI,SAAT,EAAoB;AACzB,aAAOT,QAAQ,CAACU,SAAhB;AACD;;AACD,WAAOV,QAAQ,CAACW,GAAhB;AACD,GAPgB,EAAjB;;AAUA,MAAMC,IAAI,GAAG,IAAIb,QAAJ,CAAa;AAACc,IAAAA,IAAI,EAAEP;AAAP,GAAb,CAAb;AACA,MAAMQ,KAAK,GAAG,CAACF,IAAD,CAAd;AAGAX,EAAAA,UAAU,CAACI,IAAD,EAAOS,KAAP,CAAV;AACD","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/* eslint no-console: [\"error\", { allow: [\"log\"] }] */\n/* eslint-env node, browser */\n\nimport {addDataArgs, addMetadataArg, addCondensedArg} from '../commonargs';\nimport {DumpXVIZ, DumpMode} from '../dump';\nimport {openSource} from '../connect';\n\nexport function dumpArgs(inArgs) {\n  return inArgs.command(\n    'dump <host> [log]',\n    'Print XVIZ data to stdout',\n    args => {\n      addDataArgs(args);\n      addMetadataArg(args, 'Just fetch metadata and exit');\n      addCondensedArg(args, 'Display summary information');\n    },\n    args => {\n      command(args);\n    }\n  );\n}\n\n/**\n * Validate the content and order of XVIZ messages\n */\nexport default function command(args) {\n  // Determine how verbose the user wants their output\n  const dumpMode = (() => {\n    if (args.oneline) {\n      return DumpMode.ONELINE;\n    } else if (args.condensed) {\n      return DumpMode.CONDENSED;\n    }\n    return DumpMode.ALL;\n  })();\n\n  // The middleware stack handle all messages\n  const dump = new DumpXVIZ({mode: dumpMode});\n  const stack = [dump];\n\n  // Everything async from here...\n  openSource(args, stack);\n}\n"],"file":"dump.js"}