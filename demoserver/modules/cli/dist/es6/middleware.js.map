{"version":3,"sources":["../../src/middleware.js"],"names":["XVIZMiddlewareStack","constructor","middlewares","onConnect","middlewareDispatch","onStart","msg","onError","onMetadata","onTransformLog","onStateUpdate","onTransformLogDone","onClose","name","arrayLength","length","i","middleware","handler","args","apply"],"mappings":"AAkBA,OAAO,MAAMA,mBAAN,CAA0B;AAC/BC,EAAAA,WAAW,CAACC,WAAD,EAAc;AACvB,SAAKA,WAAL,GAAmBA,WAAnB;AACD;;AAEDC,EAAAA,SAAS,GAAG;AACV,SAAKC,kBAAL,CAAwB,WAAxB;AACD;;AAEDC,EAAAA,OAAO,CAACC,GAAD,EAAM;AACX,SAAKF,kBAAL,CAAwB,SAAxB,EAAmCE,GAAnC;AACD;;AAEDC,EAAAA,OAAO,CAACD,GAAD,EAAM;AACX,SAAKF,kBAAL,CAAwB,SAAxB,EAAmCE,GAAnC;AACD;;AAEDE,EAAAA,UAAU,CAACF,GAAD,EAAM;AACd,SAAKF,kBAAL,CAAwB,YAAxB,EAAsCE,GAAtC;AACD;;AAEDG,EAAAA,cAAc,CAACH,GAAD,EAAM;AAClB,SAAKF,kBAAL,CAAwB,gBAAxB,EAA0CE,GAA1C;AACD;;AAEDI,EAAAA,aAAa,CAACJ,GAAD,EAAM;AACjB,SAAKF,kBAAL,CAAwB,eAAxB,EAAyCE,GAAzC;AACD;;AAEDK,EAAAA,kBAAkB,CAACL,GAAD,EAAM;AACtB,SAAKF,kBAAL,CAAwB,oBAAxB,EAA8CE,GAA9C;AACD;;AAEDM,EAAAA,OAAO,GAAG;AACR,SAAKR,kBAAL,CAAwB,SAAxB;AACD;;AAEDA,EAAAA,kBAAkB,CAACS,IAAD,EAAOP,GAAP,EAAY;AAC5B,UAAMQ,WAAW,GAAG,KAAKZ,WAAL,CAAiBa,MAArC;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,WAApB,EAAiCE,CAAC,EAAlC,EAAsC;AACpC,YAAMC,UAAU,GAAG,KAAKf,WAAL,CAAiBc,CAAjB,CAAnB;AAEA,YAAME,OAAO,GAAGD,UAAU,CAACJ,IAAD,CAA1B;;AAEA,UAAIK,OAAJ,EAAa;AACX,YAAIC,IAAI,GAAG,EAAX;;AAEA,YAAIb,GAAJ,EAAS;AACPa,UAAAA,IAAI,GAAG,CAACb,GAAD,CAAP;AACD;;AAEDY,QAAAA,OAAO,CAACE,KAAR,CAAcH,UAAd,EAA0BE,IAA1B;AACD;AACF;AACF;;AAtD8B","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * This takes a set of XVIZ middleware's and calls all there handlers\n * in order.\n */\nexport class XVIZMiddlewareStack {\n  constructor(middlewares) {\n    this.middlewares = middlewares;\n  }\n\n  onConnect() {\n    this.middlewareDispatch('onConnect');\n  }\n\n  onStart(msg) {\n    this.middlewareDispatch('onStart', msg);\n  }\n\n  onError(msg) {\n    this.middlewareDispatch('onError', msg);\n  }\n\n  onMetadata(msg) {\n    this.middlewareDispatch('onMetadata', msg);\n  }\n\n  onTransformLog(msg) {\n    this.middlewareDispatch('onTransformLog', msg);\n  }\n\n  onStateUpdate(msg) {\n    this.middlewareDispatch('onStateUpdate', msg);\n  }\n\n  onTransformLogDone(msg) {\n    this.middlewareDispatch('onTransformLogDone', msg);\n  }\n\n  onClose() {\n    this.middlewareDispatch('onClose');\n  }\n\n  middlewareDispatch(name, msg) {\n    const arrayLength = this.middlewares.length;\n    for (let i = 0; i < arrayLength; i++) {\n      const middleware = this.middlewares[i];\n\n      const handler = middleware[name];\n\n      if (handler) {\n        let args = [];\n\n        if (msg) {\n          args = [msg];\n        }\n\n        handler.apply(middleware, args);\n      }\n    }\n  }\n}\n"],"file":"middleware.js"}