{"version":3,"sources":["../../../src/messages/xviz-fake-pose-converter.js"],"names":["XVIZFakePose","config","frame","xvizBuilder","position","msg","topic","timestamp","length","pose","xvizStream","TimeUtil","toDate","getTime","xvizMetaBuilder","stream","category","Converter"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAaA;;AACA;;;;;;IAKaA,Y;;;;;AACX,wBAAYC,MAAZ,EAAoB;AAAA;AAAA,6BACZA,MADY;AAEnB;;;;;6GAWoBC,K,EAAOC,W;;;;;;;;AACpBC,gBAAAA,Q,GAAW,KAAKH,MAAL,CAAYG,QAAZ,IAAwB,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,C;AAEnCC,gBAAAA,G,GAAMH,KAAK,CAAC,KAAKI,KAAN,C;;oBACZD,G;;;;;;;;AAIEE,gBAAAA,S,GAAaF,GAAG,CAACA,GAAG,CAACG,MAAJ,GAAa,CAAd,C,CAAhBD,S;;AAEP,qCAAAJ,WAAW,CACRM,IADH,CACQ,KAAKC,UADb,GAEGN,QAFH,8DAEeA,QAFf,GAGGG,SAHH,CAGaI,iBAASC,MAAT,CAAgBL,SAAhB,EAA2BM,OAA3B,KAAuC,GAHpD;;;;;;;;;;;;;;;;;;gCAMUC,e,EAAiB;AAC3BA,MAAAA,eAAe,CAACC,MAAhB,CAAuB,KAAKL,UAA5B,EAAwCM,QAAxC,CAAiD,MAAjD;AACD;;;wBA3BiB;AAChB,aAAO,cAAP;AACD;;;wBAGwB;AACvB,aAAO,oBAAP;AACD;;;EAZ+BC,qB","sourcesContent":["// Copyright (c) 2019 Uber Technologies, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport Converter from './converter';\nimport {TimeUtil} from 'rosbag';\n\n// Currently every message *MUST* have a pose. However, if we don't have one\n// we can create a fake pose at (0, 0, 0) which time is set by the topic message\n// timestamp.\nexport class XVIZFakePose extends Converter {\n  constructor(config) {\n    super(config);\n  }\n\n  static get name() {\n    return 'XVIZFakePose';\n  }\n\n  // Should never match anything, but an empty string seems too fragile\n  static get messageType() {\n    return 'xviz_msgs/FakePose';\n  }\n\n  async convertMessage(frame, xvizBuilder) {\n    const position = this.config.position || [0, 0, 0];\n\n    const msg = frame[this.topic];\n    if (!msg) {\n      return;\n    }\n\n    const {timestamp} = msg[msg.length - 1];\n\n    xvizBuilder\n      .pose(this.xvizStream)\n      .position(...position)\n      .timestamp(TimeUtil.toDate(timestamp).getTime() / 1e3);\n  }\n\n  getMetadata(xvizMetaBuilder) {\n    xvizMetaBuilder.stream(this.xvizStream).category('pose');\n  }\n}\n"],"file":"xviz-fake-pose-converter.js"}